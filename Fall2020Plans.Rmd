---
title: "Fall2020Plans"
author: "Sarah Gillespie"
date: "6/15/2020"
output: html_document
---
```{r include=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# setting up the file
require(knitr)
opts_chunk$set(
  tidy=TRUE,                     # display code as typed
  size="small",                   # slightly smaller font for code
  tidy.opts=list(width.cutoff=65), # wrap text and long comments
  fig.width=7, fig.height=5           #figure size
)

knitr::opts_chunk$set(echo = TRUE)

```

```{r warning=FALSE, message=FALSE, error=FALSE}
require(tidyverse)
require(mosaic)
require(mosaicData)
require(lmtest)
library(formatR)
library(gmodels) 
library(Hmisc)
```

# relevant article https://www.chronicle.com/article/Here-s-a-List-of-Colleges-/248626?utm_source=at&utm_medium=en&utm_source=Iterable&utm_medium=email&utm_campaign=campaign_1209367&cid=at&source=ams&sourceId=378492
# data last downloaded on june 15 2020

#see if you can also consider the state's typical political leaning and the colleges rankings

```{r warning=FALSE, message=FALSE, error=FALSE}

#in excel, add the link for the Cal States and other schools with multiple campuses for easier visualization

#read in the article data
fall2020dataCoHEJun16 <- read_csv("fall2020dataCoHEJun16.csv")

#remove any doubles in the article's data
fall2020dataCoHEJun16 <- unique(fall2020dataCoHEJun16)

#separate anything with a dash, like California State University-Fresno with the specific campus being campus1
fall2020dataCoHEJun16 <- fall2020dataCoHEJun16 %>%
  separate(Institution, c("mainname", "campus1"), " â€” ")

#fall2020dataCoHEJun16 <- fall2020dataCoHEJun16[!duplicated(fall2020dataCoHEJun16$mainname), ]

#read in government data
Most_Recent_Cohorts_SMALL <- read_csv("Most-Recent-Cohorts-SMALL.csv")

#rename the school name to be institution
Most_Recent_Cohorts_SMALL <- rename(Most_Recent_Cohorts_SMALL, Institution = INSTNM)

#separate anything with a dash, like California State University-Fresno with the specific campus being campus2 that is then removed
Most_Recent_Cohorts_SMALL <- Most_Recent_Cohorts_SMALL %>%
  separate(Institution, c("mainname", "campus2"), "-") %>%
  select(-campus2)

Most_Recent_Cohorts_SMALL <- Most_Recent_Cohorts_SMALL[!duplicated(Most_Recent_Cohorts_SMALL$mainname), ]
 

KaggleRegions <- read_csv("KaggleRegions_datasets_31195_39789_states.csv")

KaggleRegions <- rename(KaggleRegions, StateL = State)

KaggleRegions <- rename(KaggleRegions, "State" = "State Code")

bigList<-merge(x=fall2020dataCoHEJun16,y=Most_Recent_Cohorts_SMALL,by="mainname",all.x=TRUE)

bigList<-merge(x=bigList,y=KaggleRegions,by="State",all.x=TRUE)

bigList<-bigList[!is.na(bigList$STABBR),]



List <- bigList %>%
  separate(Category, c("linkish", "Call1"), ">") %>%
  separate(Call1, c("Call", "extra"), "<") %>%
  select(-linkish, -extra, -UNITID, -OPEID, -OPEID6)





```

```{r}
#ALL STATES ALL SCHOOLS INCLUDING GRAD SCHOOLS

#by state

ggplot(List, aes(y = State)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#region

ggplot(List, aes(y = Region)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#division

ggplot(List, aes(y = Division)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#public vs. private

ggplot(List, aes(y = Control)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#all colleges choices

ggplot(List, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#women only
WomenOnly <- List %>%
  filter(WOMENONLY == 1)

ggplot(WomenOnly, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))


#massachusetts only

MassOnly <- List %>%
  filter(State == "MA")

ggplot(MassOnly, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE)) +
  labs(title="Massachusetts")


```

```{r}
#primarily UNDERGRAD schools that primarily confer bachelors degrees

Undergrads <- List %>%
  filter(SCH_DEG == 3)


#by state

ggplot(Undergrads, aes(y = State)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#region

ggplot(Undergrads, aes(y = Region)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#division

ggplot(Undergrads, aes(y = Division)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#public vs. private

ggplot(Undergrads, aes(y = Control)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#all colleges choices

ggplot(Undergrads, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#women only
WomenOnly <- Undergrads %>%
  filter(WOMENONLY == 1)

ggplot(WomenOnly, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))


#massachusetts only

MassOnly <- Undergrads %>%
  filter(State == "MA")

ggplot(MassOnly, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE)) +
  labs(title="Massachusetts")

```

```{r}
# high SAT score: I define this as schools with a mean score of 1350+. 1350 being the 91st percentile, undergrad

HighScore <- List

HighScore <- data.frame(lapply(HighScore, function(x) {
                  gsub("NULL", "", x)}))

HighScore$SAT_AVG <- as.numeric(as.character(HighScore$SAT_AVG))

HighScore <- HighScore %>%
  filter(SAT_AVG > 1349)  %>%
  filter(SCH_DEG == 3)


#by state

ggplot(HighScore, aes(y = State)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#region

ggplot(HighScore, aes(y = Region)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#division

ggplot(HighScore, aes(y = Division)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#public vs. private

ggplot(HighScore, aes(y = Control)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#all colleges choices

ggplot(HighScore, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE))

#massachusetts only

MassOnly <- HighScore %>%
  filter(State == "MA")

ggplot(MassOnly, aes(y = Call)) +
 geom_bar(aes(fill = Call), position = position_stack(reverse = FALSE)) +
  labs(title="Massachusetts")


```

